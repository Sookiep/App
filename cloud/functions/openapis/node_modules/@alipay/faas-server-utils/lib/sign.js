"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.sign=exports.SignOptions=void 0;const node_crypto_1=require("node:crypto");function sha256(e,s=""){return(0,node_crypto_1.createHmac)("sha256",s).update(e).digest("hex")}function getHash(e){return(0,node_crypto_1.createHash)("sha256").update(e).digest("hex")}class SignOptions{path;query;secretId;secretKey;method;body;headers;timestamp;signedHeaders;constructor(s){this.secretId=s.secretId,this.secretKey=s.secretKey,this.method=s.method,this.headers=s.headers,this.timestamp=s.timestamp,this.body=s.body,this.signedHeaders=s.signedHeaders}}exports.SignOptions=SignOptions;function sign(e){const s=e.signedHeaders.join(";");let t="";for(const a of e.signedHeaders){const u=e.headers[a];t+=`${a}:${u}
`}const n=getHash(e.body||""),d=e.method.toUpperCase()+`
`+e.path+`
`+e.query+`
`+t+`
`+s+`
`+n+`
`,r="HMAC-SHA256",c=getHash(d),h=`${r}
${e.timestamp}
${c}
`,i=sha256(h,e.secretKey);return`${r} Credential=${e.secretId}, SignedHeaders=${s}, Signature=${i}`}exports.sign=sign;