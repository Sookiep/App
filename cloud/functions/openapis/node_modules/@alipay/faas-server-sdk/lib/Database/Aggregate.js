"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Aggregate=void 0;const faas_db_builder_1=require("@alipay/faas-db-builder"),errors_1=require("../errors"),middlewares_1=require("../requester/middlewares");class Aggregate{#t;#r;#e;constructor(e,t){this.#r=e,this.#t=t,this.#e=new faas_db_builder_1.AggregateBuilder(e)}match(e){return this.#e.match(e),this}group(e){return this.#e.group(e),this}sample(e){return this.#e.sample(e),this}async end(){const{options:e}=this.#e.end(),t="POST",s=`${this.#s()}?aggregate`,r=await middlewares_1.HttpRequester.database.request(t,s,e,{},{cloudConfig:this.#t});if(!r.succeed)throw errors_1.errors.CALL_DATABASE_ERR(r);return r.data}#s(){return`${this.#t.functionDatabaseEndpoint}/${this.#t.functionDatabaseName||"faas"}/${this.#r}`}}exports.Aggregate=Aggregate;