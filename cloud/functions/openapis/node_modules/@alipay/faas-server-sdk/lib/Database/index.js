"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Database=void 0;const faas_db_builder_1=require("@alipay/faas-db-builder"),errors_1=require("../errors"),middlewares_1=require("../requester/middlewares"),Collection_1=require("./Collection");class Database{#t;command;#s;constructor(t){this.#t=t,this.command=new faas_db_builder_1.Command,this.#s=new faas_db_builder_1.MongoBuilder}collection(t){return new Collection_1.Collection(this.#t,t)}#o(){return`${this.#t.functionDatabaseEndpoint}/${this.#t.functionDatabaseName||"faas"}`}#e(t){return`${this.#o()}/${t}`}async createCollection(t){const s="PUT",o=this.#e(t),e=await middlewares_1.HttpRequester.database.request(s,o,{},{},{cloudConfig:this.#t});if(!e.succeed)throw errors_1.errors.CALL_DATABASE_ERR(e);return e.data}async getCollection(t){const s="GET",o=this.#e(t),e=await middlewares_1.HttpRequester.database.request(s,o,{},{},{cloudConfig:this.#t});if(!e.succeed)throw errors_1.errors.CALL_DATABASE_ERR(e);return e.data}async listCollection(t,s){const o="POST",e=`${this.#o()}?list`,{options:a}=this.#s.listCollection(t,s),r=await middlewares_1.HttpRequester.database.request(o,e,a,{},{cloudConfig:this.#t});if(!r.succeed)throw errors_1.errors.CALL_DATABASE_ERR(r);return r.data}async deleteCollection(t){const s="DELETE",o=this.#e(t),e=await middlewares_1.HttpRequester.database.request(s,o,{},{},{cloudConfig:this.#t});if(!e.succeed)throw errors_1.errors.CALL_DATABASE_ERR(e);return e.data}}exports.Database=Database;