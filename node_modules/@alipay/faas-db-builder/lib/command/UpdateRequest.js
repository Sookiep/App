"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UpdateRequest=void 0;const error_1=require("../common/error"),AbstractCommand_1=require("./AbstractCommand"),Operator_1=require("./Operator");class UpdateRequest{data;prefix;constructor(e,s=""){this.data=e,this.prefix=s}stringify(e){e=e||new Operator_1.Operator;for(const s in this.data){const i=this.prefix?`${this.prefix}.${s}`:s,t=this.data[s],r=typeof t;if(t instanceof AbstractCommand_1.AbstractCommand){if(!(t instanceof AbstractCommand_1.UpdateCommand))throw error_1.DbBuildError.invalidCommand("Command \u4E0D\u662F\u66F4\u65B0\u64CD\u4F5C");e.applyOperator(t.operator,i,t.stringify())}else if(r==="number")e.set(i,t);else if(r==="boolean")e.set(i,t);else if(r==="string")e.set(i,t);else if(r==="bigint")e.set(i,t);else{if(r==="function")throw error_1.DbBuildError.invalidParam(i,"\u4E0D\u652F\u6301\u51FD\u6570");if(r==="symbol")throw error_1.DbBuildError.invalidParam(i,"\u4E0D\u652F\u6301 symbol");if(r==="undefined")throw error_1.DbBuildError.invalidParam(i,"\u4E0D\u652F\u6301 undefined");t===null||Array.isArray(t)?e.set(i,t):new UpdateRequest(t,i).stringify(e)}}return e}toJSON(){return this.stringify().emit()}}exports.UpdateRequest=UpdateRequest;