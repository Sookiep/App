"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Query=void 0;const faas_db_builder_1=require("@alipay/faas-db-builder"),utils_1=require("../utils");class Query{#e;#n;#t;constructor(t,e){this.#n=t,this.#e=e,this.#t=new faas_db_builder_1.QueryBuilder(t)}limit(t){return this.#t.limit(t),this}skip(t){return this.#t.skip(t),this}where(t){return this.#t.where(t),this}projection(t){return this.#t.projection(t),this}field(t){return this.#t.projection(t),this}orderBy(t,e){return this.#t.orderBy(t,e),this}async update(t){const e="POST",s=`${this.#s()}?update`,{options:n}=this.#t.update(t),i=await this.#e.httpclient.request({method:e,path:s,data:n});return utils_1.ResponseUtil.handleResponse(i)}async set(t){const e="POST",s=`${this.#s()}?replace`,{options:n}=this.#t.set(t),i=await this.#e.httpclient.request({method:e,path:s,data:n});return utils_1.ResponseUtil.handleResponse(i)}async remove(){const t="POST",e=`${this.#s()}?delete`,{options:s}=this.#t.remove(),n=await this.#e.httpclient.request({method:t,path:e,data:s});return utils_1.ResponseUtil.handleResponse(n)}async get(){const t="POST",e=`${this.#s()}?query`,{options:s}=this.#t.get(),n=await this.#e.httpclient.request({method:t,path:e,data:s});return utils_1.ResponseUtil.handleResponse(n)}async count(){const t="POST",e=`${this.#s()}?count`,{options:s}=this.#t.count(),n=await this.#e.httpclient.request({method:t,path:e,data:s});return{total:utils_1.ResponseUtil.handleResponse(n).count}}#s(){return`/${this.#e.databaseName||"faas"}/${this.#n}`}}exports.Query=Query;