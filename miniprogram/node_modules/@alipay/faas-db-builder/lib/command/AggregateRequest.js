"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AggregateRequest=void 0;const error_1=require("../common/error"),AbstractCommand_1=require("./AbstractCommand");class AggregateRequest{data;prefix;constructor(r,t=""){this.data=r,this.prefix=t}stringify(){if(this.data instanceof AbstractCommand_1.AbstractCommand){if(!(this.data instanceof AbstractCommand_1.AggregateCommand))throw error_1.DbBuildError.invalidCommand("Command \u4E0D\u662F\u805A\u5408\u64CD\u4F5C");return this.data.stringify()}if(this.data===null)return this.data;if(Array.isArray(this.data))return this.data.map((r,t)=>new AggregateRequest(r,`${this.prefix}.$.${t}`).stringify());switch(typeof this.data){case"number":return this.data;case"boolean":return this.data;case"string":return this.data;case"bigint":return this.data;case"function":throw error_1.DbBuildError.invalidParam(this.prefix,"\u4E0D\u652F\u6301\u51FD\u6570");case"symbol":throw error_1.DbBuildError.invalidParam(this.prefix,"\u4E0D\u652F\u6301 symbol");case"undefined":throw error_1.DbBuildError.invalidParam(this.prefix,"\u4E0D\u652F\u6301 undefined");default:{const r={};for(const t in this.data){const a=this.prefix?`${this.prefix}.${t}`:t,i=this.data[t],e=new AggregateRequest(i,a);r[t]=e.stringify()}return r}}}toJSON(){return this.stringify()}}exports.AggregateRequest=AggregateRequest;